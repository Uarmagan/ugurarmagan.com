---
import { resumeData } from "../content/data";
import Section from "./Section.astro";
import {
  Card,
  CardContent,
  CardHeader,
  CardTitle,
  CardDescription,
} from "@/components/ui/card";

const { experience } = resumeData;
---

<Section id='experience' variant='fade'>
  <h2 class='text-3xl md:text-4xl font-bold font-heading mb-8'>Experience</h2>

  <p class='text-lg text-muted-foreground mb-12 max-w-3xl'>
    My professional journey across various companies and roles.
  </p>

  <div
    class='space-y-12 relative before:absolute before:inset-0 before:ml-5 before:-translate-x-px md:before:ml-[8.75rem] md:before:translate-x-0 before:h-full before:w-0.5 before:bg-gradient-to-b before:from-transparent before:via-border before:to-transparent'
  >
    {
      experience.map((item, index) => (
        <div
          class='relative flex items-start md:space-x-6'
          style={`transition-delay: ${index * 100}ms;`}
        >
          {/* Dot and Date/Location (Positioned relative to the timeline line) */}
          <div class='flex items-center flex-shrink-0 space-x-4 md:space-x-0 md:w-36 md:text-right'>
            {/* Dot indicator */}
            <div class='flex items-center justify-center w-10 h-10 rounded-full border border-border bg-background shadow text-center md:order-1 md:flex-none md:mt-1 md:w-6 md:h-6 md:border-none md:p-0 md:bg-transparent md:shadow-none z-10'>
              <div class='w-3 h-3 rounded-full bg-primary ring-4 ring-background' />
            </div>
            {/* Date / Location */}
            <time class='font-mono text-sm text-muted-foreground md:order-0 opacity-70'>
              {item.dates}
              {item.location && (
                <span class='block text-xs mt-1'>({item.location})</span>
              )}
            </time>
          </div>

          {/* Card for Experience Details */}
          <Card className='flex-1 ml-4 md:ml-0 border-border/40 transition-all duration-300 hover:border-primary/30 hover:shadow-md'>
            <CardHeader className='pb-3'>
              <CardTitle className='text-xl md:text-2xl text-foreground'>
                {item.title}
              </CardTitle>
              <CardDescription className='text-base md:text-lg'>
                {item.company}
              </CardDescription>
            </CardHeader>
            <CardContent>
              <ul class='list-disc pl-5 space-y-3 text-sm md:text-base text-muted-foreground'>
                {item.description.map((point) => (
                  <li>{point}</li>
                ))}
              </ul>
            </CardContent>
          </Card>
        </div>
      ))
    }
  </div>
</Section>

<style>
  /* Add a subtle pulse animation to the timeline dots on hover */
  .rounded-full:hover .bg-primary {
    animation: pulse 1.5s infinite;
  }

  @keyframes pulse {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.1);
      opacity: 0.8;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }
</style>
